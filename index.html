<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>üíõ</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;1,400&family=Inter:wght@300;400;500;600&family=Dancing+Script:wght@400;700&display=swap');

        *{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent}
        :root{
            --warm:#FFF8F0;--soft-pink:#FFE4E6;--rose:#FB7185;--deep-rose:#E11D48;
            --gold:#F59E0B;--dark:#1E1B2E;--storm:#0a0a12;--text-light:#FFFFFE;
            --lavender:#C4B5FD;--sky:#7DD3FC;--green:#86EFAC;--peach:#FBBF24;
        }
        html,body{width:100%;height:100%;overflow:hidden;font-family:'Inter',sans-serif}
        body{background:var(--storm);color:var(--text-light)}

        /* ============ SCENE SYSTEM ============ */
        .scene{
            position:fixed;top:0;left:0;width:100%;height:100%;
            display:flex;flex-direction:column;align-items:center;justify-content:center;
            padding:2rem 1.5rem;opacity:0;pointer-events:none;
            transition:opacity 0s;overflow-y:auto;overflow-x:hidden;z-index:1;
            will-change:transform,opacity;
        }
        .scene.active{opacity:1;pointer-events:all;z-index:10}
        .scene.slide-out-up{
            animation:slideOutUp 0.6s ease-in forwards;pointer-events:none;
        }
        .scene.slide-in-up{
            animation:slideInUp 0.6s ease-out forwards;pointer-events:all;z-index:10;
        }
        @keyframes slideOutUp{
            0%{transform:translateY(0);opacity:1}
            100%{transform:translateY(-100%);opacity:0}
        }
        @keyframes slideInUp{
            0%{transform:translateY(100%);opacity:0}
            100%{transform:translateY(0);opacity:1}
        }

        /* ============ AMBIENT CANVAS ============ */
        #ambientCanvas{position:fixed;top:0;left:0;width:100%;height:100%;z-index:0;pointer-events:none}

        /* ============ PROGRESS ============ */
        .progress-bar{position:fixed;top:0;left:0;height:3px;z-index:999;transition:width 0.8s ease;
            background:linear-gradient(90deg,var(--rose),var(--gold),var(--lavender))}

        /* ============ AUDIO BTN ============ */
        .audio-toggle{
            position:fixed;top:1rem;right:1rem;z-index:1000;
            background:rgba(255,255,255,0.08);backdrop-filter:blur(10px);
            border:1px solid rgba(255,255,255,0.12);border-radius:50%;
            width:44px;height:44px;display:flex;align-items:center;justify-content:center;
            font-size:1.2rem;cursor:pointer;transition:all 0.3s ease;color:white;
        }
        .audio-toggle:active{transform:scale(0.9)}

        /* ============ SCENE 0: DARK INTRO ============ */
        .scene-preintro{background:#000}
        .preintro-text{
            font-family:'Playfair Display',serif;font-size:1.3rem;font-weight:400;
            text-align:center;line-height:2;color:rgba(255,255,255,0.9);
            min-height:100px;
        }
        .preintro-text .cursor{
            display:inline-block;width:2px;height:1.1em;background:var(--rose);
            margin-left:2px;vertical-align:text-bottom;animation:blink .8s step-end infinite;
        }
        @keyframes blink{50%{opacity:0}}

        /* ============ SCENE 1: ENVELOPE ============ */
        .scene-intro{background:radial-gradient(ellipse at center,#1a1a2e 0%,#0a0a12 100%)}
        .intro-envelope{
            width:130px;height:95px;position:relative;cursor:pointer;
            animation:floatY 3s ease-in-out infinite;margin-bottom:2rem;
        }
        .envelope-body{
            width:100%;height:100%;background:linear-gradient(135deg,#FFE4E6,#FFC1CC);
            border-radius:4px 4px 12px 12px;position:relative;
            box-shadow:0 10px 40px rgba(251,113,133,0.3);
        }
        .envelope-flap{
            position:absolute;top:0;left:0;width:0;height:0;
            border-left:65px solid transparent;border-right:65px solid transparent;
            border-top:55px solid #FFB3C1;transform-origin:top center;transition:transform 0.6s ease;
        }
        .intro-envelope.opened .envelope-flap{transform:rotateX(180deg)}
        .envelope-heart{
            position:absolute;top:50%;left:50%;
            transform:translate(-50%,-50%);font-size:2.2rem;
            animation:pulse 1.5s ease-in-out infinite;
        }
        @keyframes floatY{0%,100%{transform:translateY(0)}50%{transform:translateY(-15px)}}
        @keyframes pulse{0%,100%{transform:translate(-50%,-50%) scale(1)}50%{transform:translate(-50%,-50%) scale(1.2)}}

        .intro-text{
            font-family:'Dancing Script',cursive;font-size:1.4rem;color:var(--soft-pink);
            opacity:0;transition:opacity 0.8s ease;text-align:center;
        }
        .intro-name{
            font-family:'Playfair Display',serif;font-size:2.4rem;font-weight:700;
            background:linear-gradient(135deg,var(--rose),var(--gold));
            -webkit-background-clip:text;-webkit-text-fill-color:transparent;
            margin:0.5rem 0 1.5rem;opacity:0;transition:opacity 0.8s ease;
        }
        .btn-start{
            background:linear-gradient(135deg,var(--rose),var(--deep-rose));color:white;border:none;
            padding:1rem 2.5rem;border-radius:50px;font-family:'Inter',sans-serif;
            font-size:1rem;font-weight:500;cursor:pointer;opacity:0;transition:all 0.4s ease;
            box-shadow:0 8px 30px rgba(225,29,72,0.4);letter-spacing:0.5px;
        }
        .btn-start.visible{opacity:1;animation:softPulse 2.5s ease-in-out infinite}
        .btn-start:active{transform:scale(0.95)}
        @keyframes softPulse{0%,100%{box-shadow:0 8px 30px rgba(225,29,72,0.4)}50%{box-shadow:0 8px 50px rgba(225,29,72,0.7)}}

        .intro-text.visible,.intro-name.visible{opacity:1}

        /* SECRET MESSAGE */
        .secret-msg{
            position:fixed;top:50%;left:50%;transform:translate(-50%,-50%) scale(0);
            background:rgba(0,0,0,0.92);backdrop-filter:blur(20px);border:1px solid var(--rose);
            border-radius:20px;padding:2rem;z-index:2000;text-align:center;
            transition:transform 0.4s cubic-bezier(0.175,0.885,0.32,1.275);
            max-width:85%;
        }
        .secret-msg.show{transform:translate(-50%,-50%) scale(1)}
        .secret-msg p{font-family:'Dancing Script',cursive;font-size:1.2rem;color:var(--rose);line-height:1.6}
        .secret-msg .close-secret{
            margin-top:1rem;background:none;border:1px solid rgba(255,255,255,0.2);
            color:white;padding:0.5rem 1.5rem;border-radius:50px;cursor:pointer;font-size:0.85rem;
        }

        /* ============ SCENE 2: STORM ============ */
        .scene-storm{background:linear-gradient(180deg,#08080f 0%,#10101e 50%,#1a1530 100%)}
        .rain-container{position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;overflow:hidden;z-index:0}
        .raindrop{
            position:absolute;top:-20px;width:2px;
            background:linear-gradient(to bottom,transparent,rgba(196,181,253,0.5));
            border-radius:0 0 2px 2px;animation:fall linear infinite;
        }
        @keyframes fall{to{transform:translateY(110vh)}}
        .lightning{
            position:fixed;top:0;left:0;width:100%;height:100%;
            background:rgba(196,181,253,0.08);opacity:0;z-index:1;pointer-events:none;
        }
        .lightning.flash{animation:lightningFlash 0.15s ease}
        @keyframes lightningFlash{0%{opacity:0}50%{opacity:1}100%{opacity:0}}

        .storm-emoji{font-size:3.5rem;margin-bottom:1rem;animation:floatY 3s ease-in-out infinite;z-index:2;position:relative}
        .storm-title{
            font-family:'Playfair Display',serif;font-size:1.8rem;font-weight:700;
            text-align:center;margin-bottom:1.2rem;color:var(--lavender);
            animation:trembleText 0.1s ease-in-out infinite;z-index:2;position:relative;
        }
        @keyframes trembleText{
            0%,100%{transform:translate(0,0)}
            25%{transform:translate(-0.5px,0.5px)}
            75%{transform:translate(0.5px,-0.5px)}
        }
        .typewriter{
            font-family:'Inter',sans-serif;font-size:1.05rem;font-weight:300;
            line-height:1.8;text-align:center;color:rgba(255,255,255,0.85);
            max-width:600px;min-height:120px;z-index:2;position:relative;
        }
        .rain-touch-msg{
            position:fixed;bottom:15%;left:50%;transform:translateX(-50%);
            font-size:1.4rem;color:rgba(255,255,255,0.9);opacity:0;
            transition:opacity 0.3s ease;z-index:50;pointer-events:none;
            font-family:'Dancing Script',cursive;
            text-shadow:0 0 20px rgba(251,113,133,0.8);
        }
        .rain-touch-msg.show{opacity:1}

        .scene-btn{
            background:rgba(255,255,255,0.08);backdrop-filter:blur(10px);
            color:white;border:1px solid rgba(255,255,255,0.15);
            padding:0.9rem 2rem;border-radius:50px;font-family:'Inter',sans-serif;
            font-size:0.95rem;font-weight:400;cursor:pointer;margin-top:2rem;
            transition:all 0.3s ease;opacity:0;z-index:2;position:relative;
        }
        .scene-btn.visible{opacity:1}
        .scene-btn:active{transform:scale(0.95);background:rgba(255,255,255,0.15)}

        /* ============ SCENE 3: TRUTH (CLOUDS) ============ */
        .scene-truth{background:linear-gradient(180deg,#10101e 0%,#1a2030 50%,#1e1b2e 100%)}
        .truth-title{font-family:'Playfair Display',serif;font-size:1.8rem;font-weight:700;text-align:center;color:var(--sky);margin-bottom:0.3rem}
        .truth-subtitle{font-family:'Dancing Script',cursive;font-size:1.05rem;color:rgba(255,255,255,0.45);margin-bottom:1.5rem;text-align:center}
        .clouds-area{
            position:relative;width:100%;max-width:500px;display:flex;
            flex-direction:column;align-items:center;gap:0.8rem;
        }
        .cloud-card{
            background:rgba(255,255,255,0.05);backdrop-filter:blur(10px);
            border:1px solid rgba(255,255,255,0.08);border-radius:20px;
            padding:1.2rem 1.5rem;width:92%;cursor:pointer;transition:all 0.5s ease;
            position:relative;overflow:hidden;
        }
        .cloud-card::before{
            content:'';position:absolute;top:0;left:0;width:100%;height:100%;
            background:linear-gradient(135deg,rgba(125,211,252,0.1),rgba(196,181,253,0.1));
            opacity:0;transition:opacity 0.5s ease;
        }
        .cloud-card.revealed::before{opacity:1}
        .cloud-label{font-size:0.8rem;font-weight:600;text-transform:uppercase;letter-spacing:1.5px;color:var(--sky);margin-bottom:0.5rem;display:flex;align-items:center;gap:0.5rem}
        .cloud-text{
            font-size:0.95rem;font-weight:300;line-height:1.7;color:rgba(255,255,255,0.85);
            max-height:0;overflow:hidden;transition:max-height 0.6s ease,opacity 0.5s ease;opacity:0;
        }
        .cloud-card.revealed .cloud-text{max-height:300px;opacity:1}
        .cloud-tap{font-size:0.75rem;color:rgba(255,255,255,0.3);text-align:center;margin-top:0.3rem;transition:opacity 0.3s}
        .cloud-card.revealed .cloud-tap{opacity:0;height:0}
        .clouds-counter{font-size:0.85rem;color:rgba(255,255,255,0.35);margin-top:0.8rem}

        /* ============ SCENE 4: LOVE ============ */
        .scene-love{background:linear-gradient(180deg,#1e1b2e 0%,#2d1532 50%,#3d1230 100%)}
        .love-title{font-family:'Playfair Display',serif;font-size:1.8rem;font-weight:700;text-align:center;color:var(--rose);margin-bottom:0.3rem}
        .love-subtitle{font-family:'Dancing Script',cursive;font-size:1.05rem;color:rgba(255,255,255,0.45);margin-bottom:1.2rem}
        .love-carousel{
            display:flex;flex-direction:column;gap:1rem;width:100%;max-width:500px;
            max-height:50vh;overflow-y:auto;padding:0.5rem;scrollbar-width:none;
        }
        .love-carousel::-webkit-scrollbar{display:none}
        .love-card{
            background:linear-gradient(135deg,rgba(251,113,133,0.1),rgba(245,158,11,0.06));
            border:1px solid rgba(251,113,133,0.15);border-radius:20px;
            padding:1.2rem 1.4rem;transform:translateY(30px);opacity:0;transition:all 0.6s ease;
        }
        .love-card.show{transform:translateY(0);opacity:1}
        .love-card-emoji{font-size:1.6rem;margin-bottom:0.4rem}
        .love-card-text{
            font-family:'Playfair Display',serif;font-size:0.95rem;font-weight:400;
            font-style:italic;line-height:1.6;color:rgba(255,255,255,0.9);
        }
        .love-card-ref{
            font-size:0.75rem;color:rgba(255,255,255,0.35);margin-top:0.4rem;
            font-style:italic;
        }

        /* ============ SCENE 5: PUZZLE ============ */
        .scene-puzzle{background:linear-gradient(180deg,#1a1a2e 0%,#1e2535 100%)}
        .puzzle-title{font-family:'Playfair Display',serif;font-size:1.6rem;font-weight:700;text-align:center;color:var(--gold);margin-bottom:0.3rem}
        .puzzle-subtitle{font-size:0.9rem;color:rgba(255,255,255,0.4);margin-bottom:1.5rem;text-align:center}
        .puzzle-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;width:280px;height:280px;margin-bottom:1.5rem}
        .puzzle-piece{
            background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);
            border-radius:14px;display:flex;align-items:center;justify-content:center;
            font-size:2rem;cursor:pointer;transition:all 0.4s ease;user-select:none;
        }
        .puzzle-piece.found{
            background:linear-gradient(135deg,rgba(251,113,133,0.15),rgba(245,158,11,0.1));
            border-color:rgba(251,113,133,0.3);animation:pieceReveal 0.5s ease;
        }
        .puzzle-piece.glow-special{
            animation:specialGlow 1.5s ease-in-out infinite !important;
            border-color:var(--gold) !important;
            box-shadow:0 0 30px rgba(245,158,11,0.5),0 0 60px rgba(251,113,133,0.3);
        }
        @keyframes pieceReveal{0%{transform:scale(0.5) rotateY(180deg)}100%{transform:scale(1) rotateY(0deg)}}
        @keyframes specialGlow{
            0%,100%{box-shadow:0 0 20px rgba(245,158,11,0.4),0 0 40px rgba(251,113,133,0.2)}
            50%{box-shadow:0 0 40px rgba(245,158,11,0.8),0 0 80px rgba(251,113,133,0.5)}
        }
        .puzzle-message{
            font-family:'Playfair Display',serif;font-size:1.05rem;font-style:italic;
            text-align:center;color:var(--gold);opacity:0;transition:opacity 0.8s ease;
            max-width:400px;line-height:1.6;
        }
        .puzzle-message.visible{opacity:1}
        .puzzle-duo{
            font-size:3rem;margin-bottom:0.5rem;opacity:0;
            transition:all 0.8s cubic-bezier(0.175,0.885,0.32,1.275);
        }
        .puzzle-duo.show{opacity:1;animation:duoGlow 2s ease-in-out infinite}
        @keyframes duoGlow{
            0%,100%{text-shadow:0 0 10px rgba(245,158,11,0.3)}
            50%{text-shadow:0 0 30px rgba(245,158,11,0.8),0 0 60px rgba(251,113,133,0.5)}
        }

        /* ============ SCENE 6: FUTURE ============ */
        .scene-future{background:linear-gradient(180deg,#1a1a2e 0%,#1e1a30 50%,#251530 100%)}
        .future-title{font-family:'Playfair Display',serif;font-size:1.7rem;font-weight:700;text-align:center;color:var(--peach);margin-bottom:0.3rem}
        .future-subtitle{font-family:'Dancing Script',cursive;font-size:1.05rem;color:rgba(255,255,255,0.45);margin-bottom:1.5rem;text-align:center}
        .future-grid{
            display:flex;flex-direction:column;gap:0.8rem;width:100%;max-width:500px;
        }
        .future-card{
            background:rgba(255,255,255,0.04);border:1px solid rgba(255,255,255,0.08);
            border-radius:18px;padding:1.1rem 1.3rem;cursor:pointer;
            transition:all 0.5s ease;transform:scale(0.95);opacity:0;
            display:flex;align-items:center;gap:1rem;
        }
        .future-card.show{transform:scale(1);opacity:1}
        .future-card.tapped{
            background:linear-gradient(135deg,rgba(251,191,36,0.1),rgba(251,113,133,0.08));
            border-color:rgba(251,191,36,0.3);
        }
        .future-card-emoji{font-size:2rem;flex-shrink:0}
        .future-card-text{font-size:0.95rem;font-weight:300;color:rgba(255,255,255,0.85);line-height:1.5}
        .future-card-hidden{
            font-family:'Dancing Script',cursive;font-size:0.9rem;color:var(--peach);
            max-height:0;overflow:hidden;transition:max-height 0.5s ease,margin 0.3s ease;margin-top:0
        }
        .future-card.tapped .future-card-hidden{max-height:100px;margin-top:0.5rem}

        /* ============ SCENE 7: PROMISES ============ */
        .scene-promises{background:linear-gradient(180deg,#1a1a2e 0%,#162016 50%,#1a2a1a 100%)}
        .promises-title{font-family:'Playfair Display',serif;font-size:1.8rem;font-weight:700;text-align:center;color:var(--green);margin-bottom:0.3rem}
        .promises-subtitle{font-family:'Dancing Script',cursive;font-size:1.05rem;color:rgba(255,255,255,0.45);margin-bottom:1.5rem;text-align:center}
        .promises-list{display:flex;flex-direction:column;gap:0.9rem;width:100%;max-width:500px}
        .promise-item{
            display:flex;align-items:flex-start;gap:1rem;
            background:rgba(134,239,172,0.04);border:1px solid rgba(134,239,172,0.1);
            border-radius:16px;padding:1rem 1.2rem;opacity:0;transform:translateX(-30px);
            transition:all 0.6s ease;position:relative;
        }
        .promise-item.show{opacity:1;transform:translateX(0)}
        .promise-icon{font-size:1.3rem;flex-shrink:0;margin-top:2px}
        .promise-text{font-size:0.93rem;font-weight:300;line-height:1.6;color:rgba(255,255,255,0.85)}
        .promise-check{
            position:absolute;top:0.8rem;right:0.8rem;font-size:1rem;
            opacity:0;transform:scale(0);transition:all 0.4s cubic-bezier(0.175,0.885,0.32,1.275);
        }
        .promise-item.checked .promise-check{opacity:1;transform:scale(1)}
        .promise-note{
            font-size:0.85rem;color:rgba(255,255,255,0.35);font-style:italic;
            text-align:center;margin-top:1.2rem;max-width:400px;line-height:1.5;
            opacity:0;transition:opacity 0.8s ease;
        }
        .promise-note.visible{opacity:1}

        /* ============ SCENE 8: FINAL ============ */
        .scene-final{background:radial-gradient(ellipse at center,#2d1532 0%,#1e1b2e 50%,#0a0a12 100%)}
        .final-heart{font-size:4.5rem;margin-bottom:1rem;animation:heartbeat 1.5s ease-in-out infinite}
        @keyframes heartbeat{0%,100%{transform:scale(1)}15%{transform:scale(1.15)}30%{transform:scale(1)}45%{transform:scale(1.1)}}
        .final-title{
            font-family:'Playfair Display',serif;font-size:2rem;font-weight:700;text-align:center;
            background:linear-gradient(135deg,var(--rose),var(--gold),var(--lavender));
            -webkit-background-clip:text;-webkit-text-fill-color:transparent;
            margin-bottom:0.5rem;line-height:1.3;
        }
        .final-counter{
            font-family:'Dancing Script',cursive;font-size:1.1rem;color:var(--rose);
            margin-bottom:1.5rem;opacity:0;transition:opacity 0.8s ease;
        }
        .final-counter.visible{opacity:1}
        .final-message{
            font-size:0.95rem;font-weight:300;line-height:1.8;text-align:center;
            color:rgba(255,255,255,0.85);max-width:500px;margin-bottom:1.5rem;min-height:100px;
        }
        .spotify-embed{
            border-radius:12px;overflow:hidden;margin-bottom:1rem;
            opacity:0;transition:opacity 0.8s ease;
        }
        .spotify-embed.visible{opacity:1}
        .btn-wha{
            background:linear-gradient(135deg,#25D366,#128C7E);color:white;border:none;
            padding:1rem 2rem;border-radius:50px;font-family:'Inter',sans-serif;
            font-size:0.95rem;font-weight:500;cursor:pointer;transition:all 0.3s ease;
            box-shadow:0 8px 30px rgba(37,211,102,0.4);display:flex;align-items:center;
            gap:0.6rem;text-decoration:none;margin-top:0.5rem;
        }
        .btn-wha:active{transform:scale(0.95)}
        .final-footer{
            position:fixed;bottom:1.5rem;font-family:'Dancing Script',cursive;
            font-size:0.95rem;color:rgba(255,255,255,0.25);z-index:10;
        }

        /* ============ STAR FIELD ============ */
        .star{
            position:fixed;border-radius:50%;background:white;pointer-events:none;
            animation:twinkle 3s ease-in-out infinite;z-index:1;
        }
        @keyframes twinkle{0%,100%{opacity:0.2}50%{opacity:0.8}}

        /* ============ CONFETTI ============ */
        .confetti-piece{
            position:fixed;width:10px;height:10px;top:-20px;z-index:100;
            animation:confettiFall linear forwards;pointer-events:none;
        }
        @keyframes confettiFall{0%{transform:translateY(0) rotate(0deg);opacity:1}100%{transform:translateY(110vh) rotate(720deg);opacity:0}}

        /* ============ FLOATING HEARTS ============ */
        .floating-heart{position:fixed;pointer-events:none;z-index:50;animation:floatUp 3s ease-out forwards;font-size:1.5rem}
        @keyframes floatUp{0%{opacity:1;transform:translateY(0) scale(1)}100%{opacity:0;transform:translateY(-200px) scale(0.3)}}

        /* ============ HEART PARTICLES (final scene) ============ */
        .heart-particle{
            position:fixed;pointer-events:none;z-index:5;font-size:1rem;
            animation:heartFloat linear forwards;
        }
        @keyframes heartFloat{
            0%{opacity:0.8;transform:translateY(0) scale(1) rotate(0deg)}
            100%{opacity:0;transform:translateY(-300px) scale(0.2) rotate(45deg)}
        }
    </style>
</head>
<body>


    <!-- Progress -->
    <div class="progress-bar" id="progressBar" style="width:0%"></div>
    <!-- Audio Toggle -->
    <div class="audio-toggle" id="audioToggle" onclick="toggleAudio()">üîá</div>
    <!-- Ambient Canvas -->
    <canvas id="ambientCanvas"></canvas>

    <!-- SECRET MESSAGE -->
    <div class="secret-msg" id="secretMsg">
        <p>Sab√≠a que ibas a tocar m√°s de una vez üòè<br>Te conozco, mi amor</p>
        <button class="close-secret" onclick="document.getElementById('secretMsg').classList.remove('show')">üíõ ya pues</button>
    </div>

    <!-- ===== SCENE 0: DARK PRE-INTRO ===== -->
    <div class="scene scene-preintro active" id="scene0">
        <div class="preintro-text" id="preintroText"></div>
    </div>

    <!-- ===== SCENE 1: ENVELOPE ===== -->
    <div class="scene scene-intro" id="scene1">
        <div class="intro-envelope" id="envelope">
            <div class="envelope-body">
                <div class="envelope-flap"></div>
                <div class="envelope-heart" id="envelopeHeart">üíå</div>
            </div>
        </div>
        <p class="intro-text" id="introText">Esto es para ti...</p>
        <h1 class="intro-name" id="introName">Mi leoncita ü¶Å</h1>
        <button class="btn-start" id="btnStart" onclick="goToScene(2)">Abrir mi coraz√≥n</button>
    </div>

    <!-- ===== SCENE 2: STORM ===== -->
    <div class="scene scene-storm" id="scene2">
        <div class="rain-container" id="rainContainer"></div>
        <div class="lightning" id="lightning"></div>
        <div class="rain-touch-msg" id="rainTouchMsg">Te extra√±√©...</div>
        <div class="storm-emoji">üåßÔ∏è</div>
        <h2 class="storm-title">La Tormenta</h2>
        <div class="typewriter" id="stormText"></div>
        <button class="scene-btn" id="btnScene2" onclick="goToScene(3)">¬øQu√© pas√≥ realmente? ‚Üí</button>
    </div>

    <!-- ===== SCENE 3: TRUTH ===== -->
    <div class="scene scene-truth" id="scene3">
        <h2 class="truth-title">Lo que no te dije</h2>
        <p class="truth-subtitle">Toca cada nube para despejarla ‚òÅÔ∏è</p>
        <div class="clouds-area" id="cloudsArea">
            <div class="cloud-card" onclick="revealCloud(this,0)">
                <div class="cloud-label">‚òÅÔ∏è La verdad es que...</div>
                <div class="cloud-text">No fue que no me importara. Me puse bravo, mi amor. Y cuando me pongo as√≠, me cierro. No soy de buscar, y eso no est√° bien. Pero que no haya ido por ti no significa que no me doliera verte irte, preciosa.</div>
                <div class="cloud-tap">toca para revelar</div>
            </div>
            <div class="cloud-card" onclick="revealCloud(this,1)">
                <div class="cloud-label">üå´Ô∏è Lo que sent√≠...</div>
                <div class="cloud-text">Rabia, pero no contigo... con la situaci√≥n. √öltimamente traigo mucha ansiedad encima por cosas que quiero lograr, y cuando se sum√≥ el problema, no supe manejarlo. Me qued√© quieto cuando deb√≠ ir por ti, morenita hermosa.</div>
                <div class="cloud-tap">toca para revelar</div>
            </div>
            <div class="cloud-card" onclick="revealCloud(this,2)">
                <div class="cloud-label">üí≠ Lo que necesito que sepas...</div>
                <div class="cloud-text">Que me cuesta much√≠simo, beb√© linda. Me cuesta hablar de estas cosas, abrirme cuando hay conflicto. Tu forma de resolver es diferente a la m√≠a, y a veces no s√© c√≥mo llegar a ti. Pero estoy aqu√≠, intent√°ndolo... a mi manera. Como Bestia aprendiendo a amar a Bella. ü•Ä</div>
                <div class="cloud-tap">toca para revelar</div>
            </div>
        </div>
        <p class="clouds-counter" id="cloudsCounter">0 de 3 nubes despejadas</p>
        <button class="scene-btn" id="btnScene3" onclick="goToScene(4)" style="display:none">Hay m√°s que quiero decirte ‚Üí</button>
    </div>

    <!-- ===== SCENE 4: LOVE ===== -->
    <div class="scene scene-love" id="scene4">
        <h2 class="love-title">Lo que siento por ti</h2>
        <p class="love-subtitle">Cada una es real, princesa</p>
        <div class="love-carousel" id="loveCarousel">
            <div class="love-card">
                <div class="love-card-emoji">üåô</div>
                <div class="love-card-text">"S√© que te quedas porque me amas con todo. Y quiero que sepas que yo tambi√©n te amo as√≠, mi amor. Como bestia ama a su princesa... con todo y las espinas."</div>
                <div class="love-card-ref">‚Äî La Bella y la Bestia ü•Ä</div>
            </div>
            <div class="love-card">
                <div class="love-card-emoji">üî•</div>
                <div class="love-card-text">"Me haces querer ser mejor, leoncita. No perfecto, mejor. Y eso es algo que nadie m√°s me ha hecho sentir en la vida."</div>
            </div>
            <div class="love-card">
                <div class="love-card-emoji">üè†</div>
                <div class="love-card-text">"Me proyecto contigo. No lo digo por decir, preciosa. Lo siento cada vez que pienso en el futuro y t√∫ est√°s en todos los escenarios, en cada uno."</div>
            </div>
            <div class="love-card">
                <div class="love-card-emoji">‚ú®</div>
                <div class="love-card-text">"Te reconocer√≠a en mil vidas, en cualquier √©poca, en cualquier lugar. Te reconocer√≠a siempre, mi amor."</div>
                <div class="love-card-ref">‚Äî Inspirado en Pocahontas üçÉ</div>
            </div>
            <div class="love-card">
                <div class="love-card-emoji">üíõ</div>
                <div class="love-card-text">"Tu sensibilidad no es un defecto, morenita hermosa. Es lo que te hace especial. A veces no s√© c√≥mo cuidarla, pero no quiero que la pierdas nunca."</div>
            </div>
            <div class="love-card">
                <div class="love-card-emoji">üê¨ü¶Å</div>
                <div class="love-card-text">"Un delf√≠n y una leona. Suena loco, ¬øno? Pero as√≠ somos. Diferentes, raros, y perfectos juntos. Te amo como bestia, mi princesa."</div>
            </div>
        </div>
        <button class="scene-btn visible" onclick="goToScene(5)" style="margin-top:1rem">A√∫n hay algo m√°s ‚Üí</button>
    </div>

    <!-- ===== SCENE 5: PUZZLE ===== -->
    <div class="scene scene-puzzle" id="scene5">
        <h2 class="puzzle-title">üß© Juntando las piezas</h2>
        <p class="puzzle-subtitle">Toca las piezas para descubrir qui√©nes somos</p>
        <div class="puzzle-grid" id="puzzleGrid"></div>
        <div class="puzzle-duo" id="puzzleDuo">üê¨ + ü¶Å = üíõ</div>
        <p class="puzzle-message" id="puzzleMessage">"A veces las piezas se desordenan, mi amor... pero siempre encajan cuando estamos juntos. Porque as√≠ somos t√∫ y yo."</p>
        <button class="scene-btn" id="btnScene5" onclick="goToScene(6)" style="display:none">Mira lo que veo para nosotros ‚Üí</button>
    </div>

    <!-- ===== SCENE 6: FUTURE ===== -->
    <div class="scene scene-future" id="scene6">
        <h2 class="future-title">Nosotros en el futuro</h2>
        <p class="future-subtitle">Toca cada sue√±o, princesa ‚ú®</p>
        <div class="future-grid" id="futureGrid">
            <div class="future-card" onclick="tapFuture(this)">
                <div class="future-card-emoji">üè°</div>
                <div>
                    <div class="future-card-text">Nuestra casa</div>
                    <div class="future-card-hidden">Con la cocina donde te voy a hacer re√≠r todas las ma√±anas, mi amor üíõ</div>
                </div>
            </div>
            <div class="future-card" onclick="tapFuture(this)">
                <div class="future-card-emoji">‚úàÔ∏è</div>
                <div>
                    <div class="future-card-text">Ese viaje que so√±amos</div>
                    <div class="future-card-hidden">T√∫ y yo perdidos en alg√∫n lugar del mundo, siendo nosotros üåç</div>
                </div>
            </div>
            <div class="future-card" onclick="tapFuture(this)">
                <div class="future-card-emoji">üê∂</div>
                <div>
                    <div class="future-card-text">Nuestra mascota</div>
                    <div class="future-card-hidden">Un animalito tan loco como nosotros, preciosa üêæ</div>
                </div>
            </div>
            <div class="future-card" onclick="tapFuture(this)">
                <div class="future-card-emoji">üë¥üëµ</div>
                <div>
                    <div class="future-card-text">Envejecer juntos</div>
                    <div class="future-card-hidden">Siendo desastrosos, peleando por el control remoto y am√°ndonos hasta el √∫ltimo d√≠a, leoncita ü§ç</div>
                </div>
            </div>
            <div class="future-card" onclick="tapFuture(this)">
                <div class="future-card-emoji">üí´</div>
                <div>
                    <div class="future-card-text">Nuestro para siempre</div>
                    <div class="future-card-hidden">"En cada vida, en cada mundo, te elijo a ti. Hasta el infinito y m√°s all√°." üöÄ</div>
                </div>
            </div>
        </div>
        <button class="scene-btn" id="btnScene6" onclick="goToScene(7)" style="display:none">Lo que voy a hacer por nosotros ‚Üí</button>
    </div>

    <!-- ===== SCENE 7: PROMISES ===== -->
    <div class="scene scene-promises" id="scene7">
        <h2 class="promises-title">No son promesas</h2>
        <p class="promises-subtitle">Son intenciones reales, con altibajos incluidos</p>
        <div class="promises-list" id="promisesList">
            <div class="promise-item">
                <div class="promise-icon">üö∂</div>
                <div class="promise-text">Voy a aprender a buscarte, mi amor. Aunque est√© bravo, aunque me cueste. Porque irme no significa que no me importe, y voy a demostr√°rtelo.</div>
                <div class="promise-check">‚úì</div>
            </div>
            <div class="promise-item">
                <div class="promise-icon">üó£Ô∏è</div>
                <div class="promise-text">Voy a intentar hablar m√°s, princesa. Aunque no me salga perfecto. Prefiero decirlo mal a no decir nada.</div>
                <div class="promise-check">‚úì</div>
            </div>
            <div class="promise-item">
                <div class="promise-icon">ü§ù</div>
                <div class="promise-text">Quiero que resolvamos juntos, no uno contra el otro. Tu forma de sentir importa, beb√© linda. Y la m√≠a tambi√©n.</div>
                <div class="promise-check">‚úì</div>
            </div>
            <div class="promise-item">
                <div class="promise-icon">üåä</div>
                <div class="promise-text">Habr√° d√≠as dif√≠ciles, leoncita. No voy a ser perfecto, y probablemente la riegue otra vez. Pero voy a estar. Siempre voy a estar.</div>
                <div class="promise-check">‚úì</div>
            </div>
            <div class="promise-item">
                <div class="promise-icon">üíõ</div>
                <div class="promise-text">Esto no es un contrato, morenita hermosa. No es algo para sacarnos en cara despu√©s. Es mi forma de decirte que estoy trabajando en m√≠... por nosotros. Juntos.</div>
                <div class="promise-check">‚úì</div>
            </div>
        </div>
        <p class="promise-note" id="promiseNote">No te pido que sea f√°cil. Solo que lo intentemos juntos, mi amor. üíõ</p>
        <button class="scene-btn" id="btnScene7" onclick="goToScene(8)" style="display:none">Un √∫ltimo paso ‚Üí</button>
    </div>

    <!-- ===== SCENE 8: FINAL ===== -->
    <div class="scene scene-final" id="scene8">
        <div class="final-heart">‚ù§Ô∏è</div>
        <h2 class="final-title">Te elijo a ti.<br>Hoy y siempre, mi leoncita.</h2>
        <div class="final-counter" id="finalCounter"></div>
        <p class="final-message" id="finalMsg"></p>
        <div class="spotify-embed" id="spotifyEmbed">
            <iframe src="https://open.spotify.com/embed/track/5Nm9ERjJZ5oyfXZTECKmRt?theme=0" width="300" height="80" frameborder="0" allow="encrypted-media" style="border-radius:12px"></iframe>
        </div>
        <a class="btn-wha" id="btnWha" href="" target="_blank" style="opacity:0">
            üí¨ Escr√≠beme al WhatsApp, mi amor
        </a>
        <p class="final-footer">hecho con el üíõ ‚Äî de tu üê¨ para su ü¶Å</p>
    </div>

    <script>
        // ============ CONFIG ============
        // IMPORTANTE: Cambia este n√∫mero por el de Sof√≠a (con c√≥digo de pa√≠s, sin +)
        const WHATSAPP_NUMBER = '573XXXXXXXXX'; // ‚Üê PON EL N√öMERO DE SOF√çA AQU√ç
        const WHATSAPP_MSG = encodeURIComponent('Mi amor, acabo de ver lo que hiciste... üíõ');

        // ============ AMBIENT CANVAS ============
        const cv = document.getElementById('ambientCanvas');
        const cx = cv.getContext('2d');
        let pts = [], ambientColor = {r:196,g:181,b:253,a:0.25};

        function resizeCV(){cv.width=innerWidth;cv.height=innerHeight}
        resizeCV(); addEventListener('resize',resizeCV);

        class Pt{
            constructor(){this.reset()}
            reset(){
                this.x=Math.random()*cv.width;this.y=Math.random()*cv.height;
                this.s=Math.random()*2+0.5;this.vy=-Math.random()*0.3-0.1;
                this.vx=(Math.random()-0.5)*0.3;this.o=Math.random()*0.5+0.1;
            }
            update(){
                this.y+=this.vy;this.x+=this.vx;
                if(this.y<-10){this.y=cv.height+10;this.x=Math.random()*cv.width}
            }
            draw(){
                cx.beginPath();cx.arc(this.x,this.y,this.s,0,Math.PI*2);
                cx.fillStyle=`rgba(${ambientColor.r},${ambientColor.g},${ambientColor.b},${this.o*ambientColor.a*4})`;
                cx.fill();
            }
        }
        for(let i=0;i<50;i++) pts.push(new Pt());
        function animPts(){cx.clearRect(0,0,cv.width,cv.height);pts.forEach(p=>{p.update();p.draw()});requestAnimationFrame(animPts)}
        animPts();

        function setAmbient(r,g,b,a){ambientColor={r,g,b,a}}

        // ============ AUDIO ============
        let audioCtx, audioPlaying = false;
        function toggleAudio(){
            const btn = document.getElementById('audioToggle');
            if(!audioPlaying){
                if(!audioCtx) audioCtx = new (window.AudioContext||window.webkitAudioContext)();
                audioPlaying = true; btn.textContent = 'üîä';
                playAmbient();
            } else {
                audioPlaying = false; btn.textContent = 'üîá';
            }
        }

        function playAmbient(){
            if(!audioPlaying||!audioCtx) return;
            const o = audioCtx.createOscillator();
            const g = audioCtx.createGain();
            o.type='sine';
            o.frequency.setValueAtTime(220+Math.random()*110, audioCtx.currentTime);
            g.gain.setValueAtTime(0, audioCtx.currentTime);
            g.gain.linearRampToValueAtTime(0.03, audioCtx.currentTime+1);
            g.gain.linearRampToValueAtTime(0, audioCtx.currentTime+3);
            o.connect(g);g.connect(audioCtx.destination);
            o.start();o.stop(audioCtx.currentTime+3);
            setTimeout(()=>{if(audioPlaying) playAmbient()}, 2500+Math.random()*2000);
        }

        // ============ SCENE MANAGEMENT ============
        let currentScene = 0;
        const totalScenes = 9;

        function goToScene(n){
            const curr = document.getElementById('scene'+currentScene);
            const next = document.getElementById('scene'+n);
            curr.classList.remove('active');
            curr.classList.add('slide-out-up');
            setTimeout(()=>{
                curr.classList.remove('slide-out-up');
                curr.style.opacity='0';curr.style.pointerEvents='none';
                next.classList.add('slide-in-up','active');
                currentScene = n;
                document.getElementById('progressBar').style.width=((n/(totalScenes-1))*100)+'%';
                initScene(n);
                setTimeout(()=>{next.classList.remove('slide-in-up')},700);
            },500);
        }

        function initScene(n){
            switch(n){
                case 1: initEnvelope(); break;
                case 2: startStorm(); break;
                case 3: setAmbient(125,211,252,0.2); break;
                case 4: showLoveCards(); break;
                case 5: initPuzzle(); break;
                case 6: showFuture(); break;
                case 7: showPromises(); break;
                case 8: startFinal(); break;
            }
        }

        // ============ SCENE 0: PRE-INTRO ============
        const preTexts = [
            "¬øRecuerdas lo que pas√≥?",
            "",
            "Yo tambi√©n.",
            "",
            "Pero hay cosas que no te dije...",
            "",
            "Cosas que necesitas saber, mi amor."
        ];
        let preIdx = 0;

        function runPreIntro(){
            const el = document.getElementById('preintroText');
            if(preIdx >= preTexts.length){
                setTimeout(()=> goToScene(1), 1000);
                return;
            }
            const txt = preTexts[preIdx];
            if(txt === ''){
                el.innerHTML = '';
                preIdx++;
                setTimeout(runPreIntro, 800);
                return;
            }
            typewriteEl(el, txt, ()=>{
                preIdx++;
                setTimeout(runPreIntro, 1500);
            });
        }

        function typewriteEl(el, text, cb){
            el.innerHTML = '<span class="cursor"></span>';
            let i=0, html='';
            function t(){
                if(i<text.length){
                    html+=text[i];
                    el.innerHTML=html+'<span class="cursor"></span>';
                    i++;
                    setTimeout(t, text[i-1]==='.'?180:text[i-1]===','?100:text[i-1]==='?'?150:40);
                } else { if(cb) setTimeout(cb,400) }
            }
            setTimeout(t,300);
        }

        setTimeout(runPreIntro, 800);

        // ============ SCENE 1: ENVELOPE ============
        let heartTaps = 0, heartTimer = null, secretShown = false;

        function initEnvelope(){
            setAmbient(196,181,253,0.25);
            const env = document.getElementById('envelope');
            setTimeout(()=>{
                env.classList.add('opened');
                setTimeout(()=>{
                    document.getElementById('introText').classList.add('visible');
                    document.getElementById('introName').classList.add('visible');
                    setTimeout(()=> document.getElementById('btnStart').classList.add('visible'),600);
                },500);
            },600);

            // Secret: 3 taps on heart
            document.getElementById('envelopeHeart').addEventListener('click',(e)=>{
                e.stopPropagation();
                heartTaps++;
                clearTimeout(heartTimer);
                heartTimer = setTimeout(()=>{heartTaps=0},800);
                if(heartTaps>=3 && !secretShown){
                    secretShown=true;
                    document.getElementById('secretMsg').classList.add('show');
                    heartTaps=0;
                }
            });
        }

        // ============ SCENE 2: STORM ============
        function startStorm(){
            setAmbient(100,100,180,0.15);
            const rc=document.getElementById('rainContainer');
            rc.innerHTML='';
            for(let i=0;i<100;i++){
                const d=document.createElement('div');d.className='raindrop';
                d.style.left=Math.random()*100+'%';
                d.style.height=Math.random()*25+15+'px';
                d.style.animationDuration=Math.random()*0.4+0.4+'s';
                d.style.animationDelay=Math.random()*2+'s';
                d.style.opacity=Math.random()*0.4+0.2;
                rc.appendChild(d);
            }
            // Lightning
            setInterval(()=>{
                if(currentScene!==2) return;
                const l=document.getElementById('lightning');
                l.classList.add('flash');
                setTimeout(()=>l.classList.remove('flash'),150);
            },4000+Math.random()*3000);

            // Rain touch = secret message
            document.getElementById('scene2').addEventListener('click',(e)=>{
                if(e.target.closest('.scene-btn')) return;
                const msg=document.getElementById('rainTouchMsg');
                msg.classList.add('show');
                setTimeout(()=>msg.classList.remove('show'),1500);
            },{passive:true});

            const txt="Hubo una tormenta entre nosotros.\n\nY en vez de buscarte... me qued√© quieto.\n\nNo porque no me importaras, mi amor.\nNo porque no te amara.\n\nSino porque me puse bravo, y cuando me pongo as√≠... me cierro.\n\nY s√© que eso te doli√≥, princesa.";
            typewriteMulti('stormText',txt,()=>{
                document.getElementById('btnScene2').classList.add('visible');
            });
        }

        function typewriteMulti(id,text,cb){
            const el=document.getElementById(id);
            el.innerHTML='<span class="cursor"></span>';
            let i=0,html='';
            function t(){
                if(i<text.length){
                    html+=text[i]==='\n'?'<br>':text[i];
                    el.innerHTML=html+'<span class="cursor"></span>';
                    i++;
                    const c=text[i-1];
                    setTimeout(t,c==='.'?200:c===','?100:c==='\n'?300:c==='‚Ä¶'?250:32);
                }else{if(cb)setTimeout(cb,500)}
            }
            setTimeout(t,400);
        }

        // ============ SCENE 3: CLOUDS ============
        let cloudsR=0;
        function revealCloud(el,idx){
            if(el.classList.contains('revealed'))return;
            el.classList.add('revealed');cloudsR++;
            document.getElementById('cloudsCounter').textContent=cloudsR+' de 3 nubes despejadas';
            spawnHeart(el);
            if(cloudsR>=3){
                setTimeout(()=>{
                    const b=document.getElementById('btnScene3');
                    b.style.display='';b.classList.add('visible');
                },600);
            }
        }

        function spawnHeart(el){
            const h=document.createElement('div');h.className='floating-heart';
            h.textContent=['üíô','üíú','ü§ç','ü¶Å','üê¨'][Math.floor(Math.random()*5)];
            const r=el.getBoundingClientRect();
            h.style.left=r.left+r.width/2+'px';h.style.top=r.top+'px';
            document.body.appendChild(h);setTimeout(()=>h.remove(),3000);
        }

        // ============ SCENE 4: LOVE CARDS ============
        function showLoveCards(){
            setAmbient(251,113,133,0.2);
            const cards=document.querySelectorAll('.love-card');
            cards.forEach((c,i)=>setTimeout(()=>c.classList.add('show'),350*i));
        }

        // ============ SCENE 5: PUZZLE ============
        const puzzleEmojis=['ü¶Å','üê¨','üíõ','üåô','üî•','üè†','‚ú®','üí´','‚ù§Ô∏è'];
        let puzzleFound=0;
        let lionFound=false, dolphinFound=false;

        function initPuzzle(){
            setAmbient(245,158,11,0.2);
            const grid=document.getElementById('puzzleGrid');grid.innerHTML='';
            const shuffled=[...puzzleEmojis].sort(()=>Math.random()-0.5);
            shuffled.forEach((em,i)=>{
                const p=document.createElement('div');p.className='puzzle-piece';
                p.textContent='?';p.style.color='rgba(255,255,255,0.25)';
                p.onclick=()=>clickPiece(p,em);
                grid.appendChild(p);
            });
        }

        function clickPiece(p,em){
            if(p.classList.contains('found'))return;
            p.classList.add('found');p.textContent=em;p.style.color='';
            puzzleFound++;spawnHeart(p);

            if(em==='ü¶Å') lionFound=true;
            if(em==='üê¨') dolphinFound=true;

            // When both are found ‚Üí special glow
            if(lionFound && dolphinFound){
                document.querySelectorAll('.puzzle-piece.found').forEach(pp=>{
                    if(pp.textContent==='ü¶Å'||pp.textContent==='üê¨') pp.classList.add('glow-special');
                });
            }

            if(puzzleFound>=puzzleEmojis.length){
                setTimeout(()=>{
                    const duo=document.getElementById('puzzleDuo');
                    duo.classList.add('show');
                    launchMiniConfetti();
                    setTimeout(()=>{
                        document.getElementById('puzzleMessage').classList.add('visible');
                        setTimeout(()=>{
                            const b=document.getElementById('btnScene5');
                            b.style.display='';b.classList.add('visible');
                        },800);
                    },800);
                },500);
            }
        }

        function launchMiniConfetti(){
            const colors=['#FB7185','#F59E0B','#C4B5FD','#7DD3FC','#86EFAC','#FFE4E6'];
            for(let i=0;i<30;i++){
                setTimeout(()=>{
                    const p=document.createElement('div');p.className='confetti-piece';
                    p.style.left=Math.random()*100+'%';
                    p.style.background=colors[Math.floor(Math.random()*colors.length)];
                    p.style.width=Math.random()*8+4+'px';p.style.height=Math.random()*8+4+'px';
                    p.style.borderRadius=Math.random()>0.5?'50%':'2px';
                    p.style.animationDuration=Math.random()*2+2+'s';
                    document.body.appendChild(p);setTimeout(()=>p.remove(),4000);
                },i*40);
            }
        }

        // ============ SCENE 6: FUTURE ============
        let futureT=0;
        function showFuture(){
            setAmbient(251,191,36,0.2);
            const cards=document.querySelectorAll('.future-card');
            cards.forEach((c,i)=>setTimeout(()=>c.classList.add('show'),300*i));
        }
        function tapFuture(el){
            if(el.classList.contains('tapped'))return;
            el.classList.add('tapped');futureT++;spawnHeart(el);
            if(futureT>=5){
                setTimeout(()=>{
                    const b=document.getElementById('btnScene6');
                    b.style.display='';b.classList.add('visible');
                },500);
            }
        }

        // ============ SCENE 7: PROMISES ============
        function showPromises(){
            setAmbient(134,239,172,0.2);
            const items=document.querySelectorAll('.promise-item');
            items.forEach((item,i)=>{
                setTimeout(()=>{
                    item.classList.add('show');
                    // Auto check after appearing
                    setTimeout(()=>item.classList.add('checked'),600);
                },500*i);
            });
            setTimeout(()=>{
                document.getElementById('promiseNote').classList.add('visible');
                setTimeout(()=>{
                    const b=document.getElementById('btnScene7');
                    b.style.display='';b.classList.add('visible');
                },800);
            },500*items.length+500);
        }

        // ============ SCENE 8: FINAL ============
        function startFinal(){
            setAmbient(251,113,133,0.3);
            createStars();
            launchBigConfetti();
            startHeartParticles();

            // Counter (pon la fecha de cuando empezaron)
            // Si no quieres contador, d√©jalo as√≠ y no se muestra
            // const startDate = new Date('2024-06-15'); // ‚Üê CAMBIA ESTA FECHA
            // const days = Math.floor((new Date()-startDate)/(1000*60*60*24));
            // const counter = document.getElementById('finalCounter');
            // counter.textContent = days + ' d√≠as eligi√©ndote, mi amor üíõ';
            // counter.classList.add('visible');

            // Spotify embed
            setTimeout(()=>document.getElementById('spotifyEmbed').classList.add('visible'),1000);

            // WhatsApp button
            const btnW=document.getElementById('btnWha');
            btnW.href='https://wa.me/'+WHATSAPP_NUMBER+'?text='+WHATSAPP_MSG;
            setTimeout(()=>btnW.style.opacity='1',2000);

            // Final message
            const msg="No soy perfecto, mi amor. Y probablemente nunca lo sea. Pero te amo con todo lo que soy, incluso con las partes que me cuestan.\n\nS√© que te quedas porque me amas much√≠simo, y yo quiero que sepas que estoy eligiendo quedarme tambi√©n. Trabajar en lo que me cuesta. Amarte como te mereces.\n\nNo con promesas grandes que despu√©s pesen... sino con intenciones reales, d√≠a a d√≠a.\n\nComo dijo el genio: \"Te doy la libertad\"... y t√∫ la usas para quedarte conmigo. Eso vale m√°s que cualquier magia, princesa. üßû\n\nTe amo como bestia, leoncita. Juntos. üê¨ü¶Åüíõ";
            typewriteMulti('finalMsg',msg,null);
        }

        function createStars(){
            for(let i=0;i<40;i++){
                const s=document.createElement('div');s.className='star';
                s.style.left=Math.random()*100+'%';s.style.top=Math.random()*100+'%';
                s.style.width=s.style.height=Math.random()*2+1+'px';
                s.style.animationDelay=Math.random()*3+'s';
                s.style.animationDuration=Math.random()*2+2+'s';
                document.getElementById('scene8').appendChild(s);
            }
        }

        function launchBigConfetti(){
            const colors=['#FB7185','#F59E0B','#C4B5FD','#7DD3FC','#86EFAC','#FFE4E6','#E11D48'];
            for(let i=0;i<80;i++){
                setTimeout(()=>{
                    const p=document.createElement('div');p.className='confetti-piece';
                    p.style.left=Math.random()*100+'%';
                    p.style.background=colors[Math.floor(Math.random()*colors.length)];
                    p.style.width=Math.random()*10+5+'px';p.style.height=Math.random()*10+5+'px';
                    p.style.borderRadius=Math.random()>0.5?'50%':'2px';
                    p.style.animationDuration=Math.random()*2.5+2+'s';
                    document.body.appendChild(p);setTimeout(()=>p.remove(),5000);
                },i*60);
            }
        }

        function startHeartParticles(){
            const emojis=['‚ù§Ô∏è','üß°','üíõ','üíú','ü§ç','ü¶Å','üê¨'];
            function spawn(){
                if(currentScene!==8)return;
                const h=document.createElement('div');h.className='heart-particle';
                h.textContent=emojis[Math.floor(Math.random()*emojis.length)];
                h.style.left=Math.random()*100+'%';h.style.bottom='-20px';
                h.style.animationDuration=Math.random()*3+3+'s';
                document.body.appendChild(h);setTimeout(()=>h.remove(),6000);
                setTimeout(spawn,300+Math.random()*500);
            }
            spawn();
        }

    </script>
</body>
</html>
